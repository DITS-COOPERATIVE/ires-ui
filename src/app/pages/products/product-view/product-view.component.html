<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
/>
<div class="container-fluid">
  <div class="row">
    <div class="col">
      <div class="prodImage">
        <label for="image-upload" class="image-label">
          <img [src]="'http://localhost:8000/' + product.image"class="img-thumbnail" alt="Product Image" />
          <span class="choose-file" *ngIf="isEditing"></span>
        </label>
        <input
          id="image-upload"
          type="file"
          accept="image/*"
          [disabled]
          style="display: none" 
          (change)="handleImageUpload($event)"
        />
      </div>
      <div class="prodKitting">
        <h3 class="text-center mt-2">Sub Product</h3>
            <div class="d-flex flex-column"  *ngIf="!isLoading && product" >
              <div *ngFor="let subProduct of product.sub_products" class="d-flex align-items-center border mb-3 p-2 justify-content-between">
                <div>
                  <img  [src]="'http://localhost:8000/' + subProduct.image"  class="rounded-circle" width="50" height="50" />
                </div>
                <div>
                  <span class="me-4">{{ subProduct.name }}</span>
                </div>
                <div *ngIf="isEditing">
                  <span (click)="deleteSubProduct(product.id, subProduct.id)"><i class="fa fa-trash"></i> </span>
                </div>
            </div>
          </div>
      </div>
    </div>
    <div class="col-lg-9">
      <div
        class="alert alert-success text-center"
        role="alert"
        *ngIf="successMessage"
      >
        {{ successMessage }}
      </div>
      <div class="container p-3">
        <form>
          <div class="icon-wrapper">
            <button class="edit-button" (click)="toggleEditButton()">
              <i
                class="fa edit-icon"
                [ngClass]="{ active: isEditing }"
                (click)="edit()"
              ></i>
            </button>
          </div>
          <div class="form-group text-center">
            <input
              type="text"
              name="product-name"
              id="product-name"
              class="form-control display-1"
              placeholder=""
              [readonly]="isReadOnly"
              [class.editable]="isEditable"
              [(ngModel)]="product.name"
              #productNameInput
            />
            <span *ngIf="errors.name" class="text-danger">{{
              errors.name
            }}</span>
          </div>
          <div class="row mt-5 ps-3">
            <div class="col-md-6">
              <div class="form-group mb-4">
                <label for="product-code" class="mb-2">Product Code</label>
                <input
                  type="text"
                  name="product-code"
                  id="product-code"
                  class="form-control"
                  placeholder=""  
                  [(ngModel)]="product.barcode"
                  #productCodeInput
                  readonly
                />
                <span *ngIf="errors.barcode" class="text-danger">{{
                  errors.code
                }}</span>
              </div>
              <div class="form-group mb-4">
                <label for="product-price" class="mb-2">Product Price</label>
                <input
                  type="text"
                  name="product-price"
                  id="product-price"
                  class="form-control"
                  placeholder=""
                  [readonly]="isReadOnly"
                  [class.editable]="isEditable"
                  [(ngModel)]="product.price"
                  #productPriceInput
                />
                <span *ngIf="errors.price" class="text-danger">{{
                  errors.price
                }}</span>
              </div>
              <div class="form-group">
                <label class="mb-2">Category</label>
                <select
                  name="product-category"
                  id="product-category"
                  class="form-control"
                  [disabled]="isReadOnly"
                  [class.editable]="isEditable"
                  [(ngModel)]="product.category"
                >
                <option value="Software">Software</option>
                <option value="Hardware">Hardware</option>
                <option value="Services">Services</option>
                </select>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group mb-4">
                <label for="product-model" class="mb-2">Product Model</label>
                <input
                  type="text"
                  name="product-model"
                  id="product-model"
                  class="form-control"
                  placeholder=""
                  [class.editable]="isEditable"
                  [readonly]="isReadOnly"
                  [(ngModel)]="product.model"
                  #productModelInput
                />
                <span *ngIf="errors.model" class="text-danger">{{
                  errors.model
                }}</span>
              </div>
              <div class="form-group mb-4">
                <label for="product-quantity" class="mb-2"
                  >Product Quantity</label
                >
                <input
                  type="text"
                  name="product-quantity"
                  id="product-quantity"
                  class="form-control"
                  placeholder=""
                  [(ngModel)]="product.quantity"
                  [class.editable]="isEditable"
                  [readonly]="isReadOnly"
                  #productQuantityInput
                 
                />
                <span *ngIf="errors.quantity" class="text-danger">{{
                  errors.quantity
                }}</span>
              </div>
              <div class="form-group mb-4">
                <label for="product-points" class="mb-2">Product Points</label>
                <input
                  type="text"
                  name="product-points"
                  id="product-points"
                  class="form-control"
                  placeholder=""
                  [readonly]="isReadOnly"
                  [class.editable]="isEditable"
                  [(ngModel)]="product.points"
                  #productPointsInput
                />
                <span *ngIf="errors.points" class="text-danger">{{
                  errors.points
                }}</span>
              </div>
            </div>
            <div class="button-group" [class.hidden]="!isEditable">
              <button class="btn btn-primary" (click)="updateProduct()">
                Save
              </button>
              <button  style="position: relative; right: 200px;" (click)="generateBarcode()" class="btn btn-success">
                View Code
              </button>  
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
